<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AMF-Placer: doc/pages/_5_explanation.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AMF-Placer
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">An Open-Source Timing-driven Analytical Mixed-size FPGA Placer</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('__5__explanation_8md.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">doc/pages/_5_explanation.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="__5__explanation_8md.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;# Implementation Explanation {#_5_explanation}</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Here, we will explain the placement flow by going through the functionality of the major modules in the placer. Of course, you can also make full use of the Doxygen diagram to trace the call graphs to understand their relationship. We try to avoid multi-level class during implementation so it is easier for beginners to trace the call graphs.</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;**Data Containers:**</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;We use a set of containers to store and analyze the information/data of design, device and placement.</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;1. DesignInfo: Information related to FPGA designs, including design cells and their interconnections. </div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;2. DeviceInfo: Information class related to FPGA device, including the details of BEL/Site/Tile/ClockRegion. </div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;3. PlacementInfo: Information related to FPGA placement (wirelength optimization, cell spreading, legalization, packing) </div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;4. PlacementTimingInfo: The container which record the timing information related to placement. </div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;   </div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;**Placement Prossors:**</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;We implement a set of placment processors, which will modify the data/information in the containers to improve the placement quality according to given metrics.</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;1. GlobalPlacer: accounts for the general iterations in global placement including wirelength optimization, cell spreading, legalization, area adjustion... </div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    * a. ClusterPlacer: cluster nodes in the given netlist and place the clusters on the device based on simulated-annealing as initial placement. </div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    * b. WirelengthOptimizer: builds numerical models based on the element locations and calls solvers to find an optimal solution of the placement. </div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    * c. GeneralSpreader: accounts for the cell spreading, which controls the cell density of specific resource type, under the device constraints for specific regions. </div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    * d. MacroLegalizer: maps DSP/BRAM/CARRY macros to legal location</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    * e. CLBLegalizer: maps CLBs (each of which consists of one site) to legal location. e.g. LUTRAM, except those CLBs in CARRY8_Chain.</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;2. InitialPacker: identifies macros from the design netlist based on pattern matching</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;3. IncrementalBELPacker: incrementally packs some LUTs/FFs during global placement based on their distance, interconnection density and compatibility</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;4. PlacementTimingOptimizer: based on the timing information and the placement information, adjusts some terms in the quadratic models which can improve the timing.</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;5. ParallelCLBPacker: finally packs LUT/FF/MUX/CARRY elements into legal CLB sites in a parallel approach.</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;**Novel Solutions:**</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;Compared to previous work, we proposed a series of novel solutions for FPGA mixed-size placements and meanwhile we provide a set of optimized extension of some latest works from the perspectives of cell spreading, congestion mitigation, clock legalization, packing and timing optimization. Here we prepare some explanation for users who are interested in the details, (where the devil is. LOL).</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;1. @subpage _5_1_WLOpt : the simulated-annealing-based initial placement and some important factors/terms in the quadratic placement target function.</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;2. @subpage _5_2_CellSpreading : the parallel solution to cell spreading for large designs with many macros and the sensitivity of partitioning-based algorithm.</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;3. @subpage _5_3_macroLegalization : high-quality high-performance progressive macro legalization of mixed-size elements in FPGA.</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;4. @subpage _5_4_packing : high-performance parallel packing considering macros and clock legalization</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;5. @subpage _5_5_timingClockingCongestion : some included optimization for timing, clocking and congestion</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;**The AMF-Placer Workflow**</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;Below is the overall flow of AMFPlacer and a visualized procedure is shown in the figure below. If you are interested in the details of AMFPlacer runtime behaviors, you can find the concrete explanation here: (@subpage _6_runtimeLog).</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;1. AMFPlacer will be constructed based on the DesignInfo and DeviceInfo. </div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;2. At the beginning, AMFPlacer will construct the PlacementInfo based on the DesignInfo and DeviceInfn. </div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;3. The element attributes, locations and densities will be initialized in the PlacementInfo. </div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;4. InitialPacker will be called by AMFPlacer to identify PlacementMacro and PlacementUnpackedCell from the design netlist.</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;5. The PlacementTimingInfo inside PlacementInfo will be initialized by constructing a TimingGraph and checking the level of DesignCell in their corresponding timing paths.</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;6. GlobalPlacer will cluster the netlist based on clock information and the connectivity and initially place the cluster on the device based on SAPlacer.</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;7. GlobalPlacer will go through some global placement iteration (wirelength optimization, cell spreading, legalization)</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;8. PlacementInfo will set a more fine-grained cell density grid.</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;9. (Again) GlobalPlacer will go through some global placement iteration (wirelength optimization, cell spreading, legalization).</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;10. IncrementalBELPacker will pair some LUTs and FFs based on their locations as an intermediate process for later packing.</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;11. PlacementTimingOptimizer will enhence some net weights for timing optimization.</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;12. GlobalPlacer will enable PlacementInfo (i.e., set neighbor displacement upperbound to a positive value) to conduct packing-aware (Improved UTPlacerF solution, considering cell resource, timing and net density. Enable earlier cell packing determination based on history analysis. Enable parallel exception handling.) Please note that congestion-aware cell area adjustion will be automatically enabled during global placement according to the placement convergence progress.</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;13. Finally, when global placement converges, ParallelCLBPacker will pack the elements into the corresponding DeviceSite / DeviceBEL.</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;&lt;center&gt;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;&lt;img src=&quot;overview.png&quot; alt=&quot;Implementation Overview&quot; title=&quot;Implementation Overview&quot; width=&quot;800&quot; /&gt; </div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;&lt;/center&gt;</div></div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="__5__explanation_8md.html">_5_explanation.md</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
