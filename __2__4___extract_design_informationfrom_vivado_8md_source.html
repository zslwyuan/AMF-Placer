<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AMF-Placer: doc/pages/_2_4_ExtractDesignInformationfromVivado.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AMF-Placer
   &#160;<span id="projectnumber">2.0</span>
   </div>
   <div id="projectbrief">An Open-Source Timing-driven Analytical Mixed-size FPGA Placer</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('__2__4___extract_design_informationfrom_vivado_8md.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">doc/pages/_2_4_ExtractDesignInformationfromVivado.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="__2__4___extract_design_informationfrom_vivado_8md.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;@page _2_4_ExtractDesignInformationfromVivado Extract Design Information from Vivado</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;# Extract Design Information from Vivado</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Users can go through the following steps to extract the information of specific designs. Please note that we have provide a set of benchmarks for VCU108 which can be found in &quot;benchmarks/VCU108/design&quot;. Please note that for a design, you can go through this extraction flow just ONE TIME. You DON&#39;T need to do this every time your run AMFPlacer.</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;* a. Please ensure that your design has sucessfully gone through the general Vivado flow to &quot;Generate Bistream&quot;. In this way, Vivado will check your design to avoid some bugs in  frond-end design stages, and meanwhile we can extrat information of your design, even part of which are some of them are blackbox IPs in Vivado, from the &quot;Implemented Design&quot; which has gone through the placement and routing of Vivado.</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;* b. Open the Tcl script &quot;benchmarks/vivadoScripts/extractDesignInfo.tcl&quot; in the project directory where you can find the below content at the beginning and modify them according to the comments suggesting.</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;```tcl</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;# replace this with the name for your benchmark</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;set benchmarkName &quot;OpenPiton&quot; </div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;# replace this path with your one to specify where to store the files of extracted data</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;set targetFolderPath &quot;/home/tingyuan/tmpFiles/&quot; </div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;```</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;* c. Open your design in Vivado and &quot;Open Implemented Design&quot; and execut the command below in the Tcl console of Vivado. It might take tens of minutes or ~1hour to finish the extraction due to the slow Tcl execution related to strings and IOs in Vivado.</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;```tcl</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;# replace XXXXX to indicate where your AMFPlacer is located.</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;source XXXXX/AMF-Placer/benchmarks/vivadoScripts/extractDesignInfo.tcl</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;```</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;* d. Finally, you should be able to find the extracted files in target folder path set by you. Below is an example showing the generated files for OpenPiton:</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;&lt;center&gt;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;&lt;img src=&quot;designFiles.png&quot; align=&quot;center&quot;  alt=&quot;Design Files&quot; title=&quot;Design Files&quot; width=&quot;300&quot; /&gt; </div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;&lt;/center&gt;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;Below is an example showing what text file is in the extracted archive file, e.g. OpenPiton_allCellPinNet.zip in the screenshot. </div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;We organize the content in the file mainly for user readibility and easier debugging/checking in Vivado. The information of each cell will cost multiple lines. </div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;The first line for a cell in the design netlist will be the one begin with &quot;curCell=&gt; &quot; and provide the name and type of the cell.</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;Then the following lines after this cell declaration are the lines for the pins on this cell. Each of these lines begins with &quot;pin=&gt;&quot;. </div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;The pin information will keep loading until another line beginning with &quot;curCell=&gt; &quot; is found.</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;For each pin, the name, reference name on cell, IO direction relative to the cell, the name of connected net and the name of the driver pin of the connected net will be provided in one line.</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;\verbatim</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;```perl</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;curCell=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data[7]_i_9 type=&gt; LUT6</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   pin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data[7]_i_9/O refpin=&gt; O dir=&gt; OUT net=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data[7]_i_9_n_0 drivepin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data[7]_i_9/O</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   pin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data[7]_i_9/I0 refpin=&gt; I0 dir=&gt; IN net=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r0_data[223] drivepin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r0_data_reg[223]/Q</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   pin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data[7]_i_9/I1 refpin=&gt; I1 dir=&gt; IN net=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r0_data[95] drivepin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r0_data_reg[95]/Q</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   pin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data[7]_i_9/I2 refpin=&gt; I2 dir=&gt; IN net=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r0_out_sel_next_r_reg[3] drivepin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r0_out_sel_next_r_reg[3]/Q</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   pin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data[7]_i_9/I3 refpin=&gt; I3 dir=&gt; IN net=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r0_data[159] drivepin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r0_data_reg[159]/Q</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;   pin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data[7]_i_9/I4 refpin=&gt; I4 dir=&gt; IN net=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r0_out_sel_next_r_reg[4] drivepin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r0_out_sel_next_r_reg[4]/Q</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   pin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data[7]_i_9/I5 refpin=&gt; I5 dir=&gt; IN net=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r0_data[31] drivepin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r0_data_reg[31]/Q</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;curCell=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data_reg[0] type=&gt; FDRE</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   pin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data_reg[0]/Q refpin=&gt; Q dir=&gt; OUT net=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data[0] drivepin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data_reg[0]/Q</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   pin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data_reg[0]/C refpin=&gt; C dir=&gt; IN net=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/aclk drivepin=&gt; design_1_i/xilinx_dma_pcie_ep_0/inst/xdma_0_i/inst/pcie3_ip_i/inst/xdma_0_pcie3_ip_gt_top_i/phy_clk_i/bufg_gt_userclk/O</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   pin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data_reg[0]/CE refpin=&gt; CE dir=&gt; IN net=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data_0 drivepin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data[7]_i_1/O</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   pin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data_reg[0]/D refpin=&gt; D dir=&gt; IN net=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/p_0_in[0] drivepin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data[0]_i_1/O</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   pin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data_reg[0]/R refpin=&gt; R dir=&gt; IN net=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/&lt;const0&gt; drivepin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/GND/G</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;curCell=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data_reg[0]_i_2 type=&gt; MUXF7</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   pin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data_reg[0]_i_2/O refpin=&gt; O dir=&gt; OUT net=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data_reg[0]_i_2_n_0 drivepin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data_reg[0]_i_2/O</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   pin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data_reg[0]_i_2/I0 refpin=&gt; I0 dir=&gt; IN net=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data[0]_i_6_n_0 drivepin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data[0]_i_6/O</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   pin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data_reg[0]_i_2/I1 refpin=&gt; I1 dir=&gt; IN net=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data[0]_i_7_n_0 drivepin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data[0]_i_7/O</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   pin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r1_data_reg[0]_i_2/S refpin=&gt; S dir=&gt; IN net=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r0_out_sel_next_r_reg[2] drivepin=&gt; design_1_i/axis_dwidth_converter_0/inst/gen_downsizer_conversion.axisc_downsizer_0/r0_out_sel_next_r_reg[2]/Q</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;```</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;\endverbatim</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;Besides, we also extract the clock information/fixed elements/vendor primitive macros of the design from Vivado. </div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;In the clock information file, e.g., OpenPiton_clocks, each line will be the name of clock driver pin. This information will be used for clock legalization.</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;In the fixed element file, e.g., OpenPiton_fixedUnits, each line will describe a fixed element with its name, location site and location BEL in the site.</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;In the unpredictable macro file, e.g., OpenPiton_unpredictableMacros, each line will describe a macro that AMF-Placer cannot precisely/properly extract currently (usually they are the clock-domain-crossing FFs or small low-bitwidth LUTRAMs), with their name, their location site in the post-implementation design and the location BEL. Usually, the site of these element can be changed but their locations relative to those elements in the same site/neighbor site cannot be changed. Mose of the macros we can infer their build rules but for some other macros we cannot infer. Therefore, for these &quot;unpredictable&quot; macros, we need to extract the information from Vivado instead of building them via InitialPacker.</div></div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="__2__4___extract_design_informationfrom_vivado_8md.html">_2_4_ExtractDesignInformationfromVivado.md</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
